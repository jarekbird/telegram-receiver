# PHASE2-100: Create service test fixtures

**Section**: 13. Testing
**Subsection**: 13.1
**Task ID**: PHASE2-100

## Description

Create service test fixtures for Telegram updates. These fixtures should provide reusable test data for Telegram update objects that match the Telegram Bot API format, including message updates, edited messages, and callback queries.

## Rails Reference

Reference the following Rails test files for examples of Telegram update structures:

- `jarek-va/spec/controllers/telegram_controller_spec.rb` - Shows update structures for messages, edited_messages, and callback_queries
- `jarek-va/spec/jobs/telegram_message_job_spec.rb` - Shows message update structures with commands and non-command messages
- `jarek-va/app/jobs/telegram_message_job.rb` - Shows how updates are processed (handles `update['message']`, `update['edited_message']`, `update['callback_query']`)

## Checklist

- [ ] Create `tests/fixtures/telegram-updates.ts`
- [ ] Create sample message updates:
  - [ ] Command message (`/start` command)
  - [ ] Command message (`/help` command)
  - [ ] Command message (`/status` command)
  - [ ] Non-command text message (for forwarding to cursor-runner)
  - [ ] Message with minimal required fields (for edge case testing)
- [ ] Create sample callback queries:
  - [ ] Callback query with data and message reference
  - [ ] Callback query with minimal fields
- [ ] Create sample edited messages:
  - [ ] Edited message with text update
  - [ ] Edited message with minimal fields
- [ ] Export all fixtures for use in tests
- [ ] Include helper function to create custom updates with overrides (similar to existing `createTelegramMessage` pattern)

## Notes

- This task is part of Phase 2: File-by-File Conversion
- Section: 13. Testing
- Reference the Rails implementation for behavior
- Telegram updates follow the format: `{ 'message': {...} }`, `{ 'edited_message': {...} }`, or `{ 'callback_query': {...} }`
- Update objects should match the Telegram Bot API Update structure
- Consider creating fixtures that match the test data used in Rails specs (see `telegram_controller_spec.rb` and `telegram_message_job_spec.rb`)
- The existing `tests/fixtures/telegramMessages.ts` file contains some fixtures but uses `update_id` at the top level; this new file should focus on the update wrapper structure used by the application

- Task can be completed independently by a single agent

## Related Tasks

- Previous: PHASE2-099
- Next: PHASE2-101

## Definition of Done

This document defines the criteria for task completion. The review agent uses these definitions to evaluate whether a task has been completed successfully.

### 1. CODE/FILE WRITING TASKS

**Description**: Tasks that involve writing, creating, modifying, or implementing SOURCE CODE FILES that need to be committed to git.

**Definition of Done**: "A Pull Request was created OR code was pushed to origin with the task complete"

**Examples**:
- Creating new source code files
- Modifying existing source code files
- Implementing features, functions, classes, modules
- Writing tests, specs
- Refactoring code
- Fixing bugs in source code

### 2. SYSTEM/ENVIRONMENT OPERATION TASKS

**Description**: Tasks involving installing dependencies, running builds, installing packages, running migrations, executing install scripts, etc.

**Definition of Done**: "The required operation must complete successfully with no errors, and the expected artifacts must be created. If any part of the operation fails, the task is NOT complete."

**Important Notes**:
- Installing dependencies requires packages to actually be installed successfully
- Updating package.json is NOT enough
- If the output mentions environmental issues, errors, warnings, or failed operations, the task is NOT complete

**Examples**:
- Installing npm packages, pip packages, gem dependencies
- Running database migrations
- Building/compiling projects
- Setting up development environments
- Running install scripts

